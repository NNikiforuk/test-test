---
import Layout from "../../layouts/Layout.astro";
import directus from "../../lib/directus";
import { readItems } from "@directus/sdk";

export async function getStaticPaths() {
	try {
		const posts = await directus.request(
			readItems("posts", {
				fields: [
					"slug",
					"title",
					"content",
					"image",
					"author",
					"published_date",
				],
			})
		);

		return posts.map((post) => ({
			params: { slug: post.slug },
			props: post,
		}));
	} catch (error) {
		console.error("Error fetching posts:", error);
		return [];
	}
}
const post = Astro.props;
---

<Layout title={post.title}>
	<main>
		<img src={`YOUR_DIRECTUS_URL/assets/${post.image}?width=500`} />
		<h1>{post.title}</h1>
		<div set:html={post.content} />
	</main>
</Layout>
